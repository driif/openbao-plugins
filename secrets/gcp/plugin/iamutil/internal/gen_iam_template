{{define "main"}}
// THIS FILE IS AUTOGENERATED USING go generate. DO NOT EDIT.
package iamutil

func GetEnabledIamResources() EnabledResources {
    return &generatedIamResources{
        resources: generatedResources,
 	}
}

var generatedServices = {{ template "services" .Services }}

var generatedResources = {{ template "resources" .Resources }}

{{end}}

{{define "services" -}}
map[string]map[string]*ServiceConfig{
{{ range $service,$serviceMap := . -}}
    "{{$service}}": {
        {{ range $ver, $cfg := $serviceMap -}}
            "{{$ver}}": &{{template "service_config" $cfg}},
        {{ end -}}
    },
{{ end -}}
}
{{- end }}

{{define "resources" -}}
map[string]map[string]map[string]*IamResourceConfig{
{{ range $resourceTypeKey,$serviceMap := . -}}
    "{{$resourceTypeKey}}": {
        {{ range $service, $versionMap := $serviceMap -}}
            "{{$service}}": {
                {{ range $ver, $cfg := $versionMap -}}
                    "{{$ver}}": &IamResourceConfig{
                        Service: generatedServices["{{$service}}"]["{{$ver}}"],
                        SetIamPolicy: &{{ template "http_method_cfg" $cfg.SetIamPolicy }},
                        GetIamPolicy: &{{ template "http_method_cfg" $cfg.GetIamPolicy }},
                    },
                {{ end -}}
            },
        {{ end -}}
    },
{{ end -}}
}
{{- end }}

{{define "service_config" -}}
ServiceConfig{
	Name: "{{ .Name }}",
	Version: "{{ .Version }}",
	IsPreferredVersion: {{ .IsPreferredVersion }},
	RootUrl: "{{ .RootUrl }}",
	ServicePath: "{{ .ServicePath }}",
}
{{- end}}

{{define "http_method_cfg" -}}
HttpMethodCfg{
 	HttpMethod: "{{ .HttpMethod }}",
 	Path: "{{ .Path }}",
 	ReplacementKeys: {{ template "string_map" .ReplacementKeys }},
}
{{- end}}

{{define "string_map" -}}
map[string]string {
{{ range $k, $v := . -}}
    "{{$k}}": "{{$v}}",
{{ end -}}
}
{{- end}}